<!DOCTYPE html>
<html>
<head>
	<title>Student Management System</title>


<!--   for scroll and model-dialog -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>	
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">

<!-- for model dialog -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>

  <style type="text/css">
.scrollable{
  height: 400px;
  width: 1000px;
  overflow:scroll;
}

</style>
  </head>

  <body class="col-md-12">
	 <h1>Student Management System</h1>
     <div class="dropdown">
    			<strong>Select rows desplay:</strong>
  	 	  	<select id="myDropdown">
      			<option value="10" selected>10</option>
    	 	   	<option value="20">20</option>
   	 	  		<option value="50">50</option>
   	 		 	  <option value="100">100</option>
   	 	  	</select><br>
          <strong>Search by:</strong>
          <select id="searchKey">
    			  <option value="firstname" selected>first name</option>
    			  <option value="lastname">last name</option>
   	 			  <option value="email">email</option>
   	 			  <option value="phone">phone</option>
        </select>
        <input type="text" id="studentSearch" placeholder="Press Enter to Search"><br>
  </div>



<!-- Details Model-dialog-->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="exampleModalLabel" >Marks</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <!--  marks -->
        <div class="row">
          <div class="col-3">
            <label>English:</label>
            <p id="detail_marks_english"></p>
          </div>
          <div class="col-3">
            <label>Science:</label>
            <p id="detail_marks_science"></p>
          </div>
          <div class="col-3">
            <label>Computers:</label>
            <p id="detail_marks_computers"></p>
          </div>
          <div class="col-3">
            <label>Hardware:</label>
            <p id="detail_marks_hardware"></p>
          </div>
        </div>
        <!-- end of marks -->
      </div>
<!--       <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div> -->
    </div>
  </div>
</div>




<!-- Edit Model-dialog-->
<div class="modal fade" id="Modal-edit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="exampleModalLabel">Edit Information</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <!--  edit information  -->
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>First name:</label> -->
            <input type="text" id="editFirstName" placeholder="First Name">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
           <!-- <label>Last name:</label> -->
            <input type="text" id="editLastName" placeholder="Last Name">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>Email:</label> -->
            <input type="email" id="editEmail" placeholder="Email">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>Location:</label> -->
            <input type="text" id="editLocation" placeholder="Location">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>Phone:</label> -->
            <input type="number" id="editPhone" placeholder="Phone">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>communication Address:</label> -->
            <input type="text" id="editCommunicationAddress" placeholder="Communication Address">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
            <!-- <label>Permanent Address:</label> -->
            <input type="text" id="editPermanentAddress" placeholder="Permanent Address">
            </div>
        </div>
        <div class="row">
          <div class="col-lg-12 text-center">
              <!-- <label>English Mark:</label> -->
              <input type="number" id="editMarks_English" placeholder="English Mark">
              </div>
            </div>
        <div class="row">
          <div class="col-lg-12 text-center">
              <!-- <label>Science Mark:</label> -->
              <input type="number" id="editMarks_Science" placeholder="Science Mark">
              </div>
            </div>
        <div class="row">
          <div class="col-lg-12 text-center">
              <!-- <label>Computers Mark:</label> -->
              <input type="number" id="editMarks_Computers" placeholder="Computers Mark">
              </div>
            </div>
        <div class="row">
          <div class="col-lg-12 text-center">
              <!-- <label>Hardware Mark:</label> -->
              <input type="number" id="editMarks_Hardware" placeholder="Hardware Mark">
              </div>
            </div>
        <!-- end of edit information -->
      </div >
      <div class="col-md-4 text-center"> <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="editStudent();" style="width:150px;">Save Changes</button></div>
     
    </div>
  </div>
</div>


<!-- Delete Model-dialog-->
<div class="modal fade" id="Modal-delete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="exampleModalLabel">Are you sure to delete this record?</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
<!--       <div class="modal-body">
      </div> -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="deleteStudent();">Yes</button>
      </div>
    </div>
  </div>
</div>



 <!--      display selected rows of students' records -->
  		<span id="display-resources" ></span>

<!--  end of html body -->
  </body>
</html>


<script>
var students = JSON.parse(localStorage.getItem('userList'));
$(document).ready(function(){
    	$.ajax({
   		   type: "GET",
   			// url: "http://127.0.0.1:8887/jquery assignment dummy data.json", 
        url:"http://127.0.0.1:8887/jquery%20assignment%20dummy%20data.json",
        // Using our resources.json file to serve results
     		success:
     		 function (data) {
            	localStorage.setItem("userList",JSON.stringify(data));
            	studentTable(10);
        }
    	});
});


var inputString;
var searchBy;
$("input[type='text']").keypress(function(event){
  //13 = enter key
  if(event.which === 13){
  inputString = $("input[type='text']").val()
  searchBy = $("#searchKey").val();
  searchStudent(inputString,searchBy);
}
})


function searchStudent(inputString,searchBy){
  var displayResources = $("#display-resources");
  var output = '<div class = "container"><div class="row"><div class="col-md-6"><div class="scrollable"><table class="table table-bordered text-center"><thead><tr><td>firstname</td><td>lastname</td><td>email</td><td>location</td><td>phone</td><td>address</td><td>options</td><td></td><td></td></tr></thead><tbody>';

  if(searchBy == "firstname"){
    for(var i = 0; i < students.length; i++){
        if(students[i].firstname == inputString){
            output +=
              '<tr><td>' + students[i].firstname +
              '</td><td>' + students[i].lastname +
              '</td><td>' + students[i].email +
              '</td><td>' + students[i].location +
              '</td><td>' + students[i].phone +
              '</td><td>' + students[i].address.communication + 
                            students[i].address.permanent +
              //"</td><td>" + students[i].marks +
              '<td><a href="#" id="detail-'+i+'" onclick="showDetails('+i+');" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Details</a></td>' +
              '<td><a href="#" id="edit-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-edit">Edit</a></td>' + 
              '<td><a href="#" id="delete-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-delete">Delete</a></td></tr>';
            }
          }
        }
  else if(searchBy == "lastname"){
    for(var i = 0; i < students.length; i++){
    if(students[i].lasttname == inputString){
            output +=
              '<tr><td>' + students[i].firstname +
              '</td><td>' + students[i].lastname +
              '</td><td>' + students[i].email +
              '</td><td>' + students[i].location +
              '</td><td>' + students[i].phone +
              '</td><td>' + students[i].address.communication + 
                            students[i].address.permanent +
              //"</td><td>" + students[i].marks +
              '<td><a href="#" id="detail-'+i+'" onclick="showDetails('+i+');" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Details</a></td>' +
              '<td><a href="#" id="edit-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-edit">Edit</a></td>' + 
              '<td><a href="#" id="delete-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-delete">Delete</a></td></tr>';
            }
          }
        }
  else if(searchBy == "phone"){
    for(var i = 0; i < students.length; i++){
    if(students[i].phone == inputString){
            output +=
              '<tr><td>' + students[i].firstname +
              '</td><td>' + students[i].lastname +
              '</td><td>' + students[i].email +
              '</td><td>' + students[i].location +
              '</td><td>' + students[i].phone +
              '</td><td>' + students[i].address.communication + 
                            students[i].address.permanent +
              //"</td><td>" + students[i].marks +
              '<td><a href="#" id="detail-'+i+'" onclick="showDetails('+i+');" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Details</a></td>' +
              '<td><a href="#" id="edit-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-edit">Edit</a></td>' + 
              '<td><a href="#" id="delete-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-delete">Delete</a></td></tr>';
            }
          }
        }
  else if(searchBy == "email"){
    for(var i = 0; i < students.length; i++){
    if(students[i].email == inputString){
            output +=
              '<tr><td>' + students[i].firstname +
              '</td><td>' + students[i].lastname +
              '</td><td>' + students[i].email +
              '</td><td>' + students[i].location +
              '</td><td>' + students[i].phone +
              '</td><td>' + students[i].address.communication + 
                            students[i].address.permanent +
              //"</td><td>" + students[i].marks +
              '<td><a href="#" id="detail-'+i+'" onclick="showDetails('+i+');" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Details</a></td>' +
              '<td><a href="#" id="edit-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-edit">Edit</a></td>' + 
              '<td><a href="#" id="delete-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-delete">Delete</a></td></tr>';
            }
          }
        }
        output += "</tbody></table>";
        displayResources.html(output);
      }



$("#myDropdown").change(function () {
	var num = $("#myDropdown").val();
        studentTable(num);
        studentDetails(num);

    })


function studentTable(num) {
	    	var displayResources = $("#display-resources");
    
          var output = '<div class = "container"><div class="row"><div class="col-md-6"><div class="scrollable"><table class="table table-bordered text-center"><thead><tr><td>firstname</td><td>lastname</td><td>email</td><td>location</td><td>phone</td><td>address</td><td>options</td><td></td><td></td></tr></thead><tbody>';
     	   	
    	    for(var i = 0; i < num; i++) {
    	      output +=
   		        '<tr><td>' + students[i].firstname +
        	    '</td><td>' + students[i].lastname +
           	 	'</td><td>' + students[i].email +
           		'</td><td>' + students[i].location +
            	'</td><td>' + students[i].phone +
            	'</td><td>' + students[i].address.communication + 
                            students[i].address.permanent +
            	//"</td><td>" + students[i].marks +
              '<td><a href="#" id="detail-'+i+'" onclick="holdVar('+i+')"" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Details</a></td>' +
              '<td><a href="#" id="edit-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-edit">Edit</a></td>' + 
              '<td><a href="#" id="delete-'+i+'" onclick="holdVar('+i+')" class="btn btn-primary" data-toggle="modal" data-target="#Modal-delete">Delete</a></td></tr>';

       		 }
        	output += "</tbody></table>";
	        displayResources.html(output);
}



//the variable "holdI" contains the index of the student record in the local storage "students"
var holdI;
function holdVar(i){
  holdI = i;
}

//more options
function showDetails() {
    var i = holdI;
    $('#detail_marks_english').text(students[i].marks.english);
    $('#detail_marks_science').text(students[i].marks.science);
    $('#detail_marks_computers').text(students[i].marks.computers);
    $('#detail_marks_hardware').text(students[i].marks.hardware);
}


function editStudent(){
    var i = holdI;
    var firstName = $('#editFirstName').val();
    var lastName = $('#editLastName').val();
    var email = $('#editEmail').val();
    var location = $('#editLocation').val();
    var phone = $('#editPhone').val();
    var addCommunication = $('#editCommunicationAddress').val();
    var addrPermanent = $('#editPermanentAddress').val();
    var english = $('#editMarks_English').val();
    var science = $('#editMarks_Science').val();
    var computer = $('#editMarks_Computer').val();
    var hardware = $('#editMarks_Hardware').val();
    
    if(firstName){
      students[i].firstname = firstName;
    }
    if(lastName){
      students[i].lastname = lastName;
    }
    if(email){
      students[i].email = email;
    }
    if(location){
      students[i].location = location;
    }
    if(lastName){
      students[i].phone = phone;
    }
    if(lastName){
      students[i].communication = addCommunication;
    }
    if(lastName){
      students[i].permanent = addrPermanent;
    }
    if(lastName){
      students[i].english = english;
    }
    if(lastName){
      students[i].science = science;
    }
    if(lastName){
      students[i].computer = computer;
    }
    if(lastName){
      students[i].hardware = hardware;
    }

    studentTable($("#myDropdown").val());
}


function deleteStudent(){
  var i = holdI;
  students.splice(i, 1);
  studentTable($("#myDropdown").val());
}
</script>





